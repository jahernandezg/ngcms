<div  class="overflow-hidden rounded-2xl border border-gray-200 bg-white px-4 pb-3 pt-4 mt-5 dark:border-gray-800 dark:bg-white/3 sm:px-6">
  <div class="flex flex-col gap-2 mb-4 sm:flex-row sm:items-center sm:justify-between">
    <div>
      <h3 class="text-lg font-semibold text-gray-800 dark:text-white/90">
        {{isNew() ? 'Nuevo Post' : 'Editar Post'}}
      </h3>

    </div>

    <div class="flex items-center gap-3">

      <button (click)="save('DRAFT')"[disabled]="saving()"
        class="inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-gray-600 px-4 py-2.5 text-theme-sm font-medium text-white shadow-theme-xs hover:bg-gray-50 hover:text-gray-800 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] dark:hover:text-gray-200">
        Guardar Borrador
      </button>

      <button (click)="save('PUBLISHED')"[disabled]="saving()"
        class="inline-flex items-center gap-2 rounded-lg border border-brand-300 bg-brand-600 px-4 py-2.5 text-theme-sm font-medium text-white shadow-theme-xs hover:bg-brand-50 hover:text-brand-800 dark:border-brand-700 dark:bg-brand-800 dark:text-brand-400 dark:hover:bg-white/[0.03] dark:hover:text-brand-200">
        Publicar
      </button>
    </div>
  </div>

  <div class="w-full overflow-x-auto">
  @if (success()) {
    <app-admin-alert [variant]="'success'" title="Éxito" [message]="success()!" (closed)="success.set(null)" />
  }
  <form class="space-y-4" [formGroup]="form" (ngSubmit)="save()">
    <div class="grid md:grid-cols-3 gap-6">
      <div class="md:col-span-2 space-y-4">
        <div>
      <label for="title" class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Título</label>
      <input id="title" type="text" formControlName="title" class="dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" />
    </div>
    <div>
      <label for="excerpt" class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Excerpt</label>
      <textarea id="excerpt" formControlName="excerpt" rows="3" class="dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30"></textarea>
    </div>
    <div>
      <label for="content" class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Contenido (HTML permitido)</label>
      <textarea id="content" formControlName="content" rows="14" class="dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" placeholder="<h2>Título</h2><p>Contenido...</p>"></textarea>
      <p class="mt-1 text-[10px] text-gray-500 dark:text-gray-400">Pega/edita HTML directamente. Se sanitiza al guardar.</p>
    </div>
      </div>
      <div class="space-y-6">
        <div>
          <p class="text-sm font-medium mb-2 text-gray-700 dark:text-gray-400">Categorías</p>
          @if (categories().length) {
          <div class="max-h-40 overflow-auto border dark:text-gray-400 dark:border-gray-600 rounded divide-y divide-gray-200 dark:divide-gray-700 bg-white dark:bg-gray-800/60">
            @for (c of categories(); track c.slug) {
            <label class="flex items-center gap-2 px-2 py-1 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/70 transition-colors">
              <input type="checkbox" [checked]="selectedCategories().includes(c.slug)" (change)="toggleCategory(c.slug, $any($event.target).checked)" />
              <span class="text-sm text-gray-800 dark:text-gray-200">{{c.name}}</span>
            </label>
            }
          </div>
          } @else {
            <p class="text-xs text-gray-500 dark:text-gray-400">Sin categorías</p>
          }
        </div>
        <div>
          <p class="text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">Tags</p>
          @if (tags().length) {
          <div class="max-h-40 overflow-auto border dark:text-gray-400 dark:border-gray-600 rounded divide-y divide-gray-200 dark:divide-gray-700 bg-white dark:bg-gray-800/60">
            @for (t of tags(); track t.slug) {
            <label class="flex items-center gap-2 px-2 py-1 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/70 transition-colors">
              <input type="checkbox" [checked]="selectedTags().includes(t.slug)" (change)="toggleTag(t.slug, $any($event.target).checked)" />
              <span class="text-sm text-gray-800 dark:text-gray-200">{{t.name}}</span>
            </label>
            }
          </div>
          } @else {
            <p class="text-xs text-gray-500 dark:text-gray-400">Sin tags</p>
          }
        </div>
      </div>
    </div>
  </form>
  @if (error()) {
    <app-admin-alert [variant]="'error'" title="Error" [message]="error()!" (closed)="error.set(null)" />
  }
  </div>
</div>
































